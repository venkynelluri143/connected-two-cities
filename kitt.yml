# Required minimal config
owner:
  group: corehr-wcnp-developers # change to your own group 
notify:
  slack:
    channelName: corehr-wcnp-hcm-nonprod #change to your own slack channel 
profiles:
  - springboot-web
setup:
  releaseRefs: ["featurebranch","GAI_KITTIntegration"]
  featureFlagMap:
    enableIstioSidecar: true
# Needed to get container to start, depends on app  
deploy:
  namespace: getassoc-service
  releaseType:
   deployTimeout: 1000
  changeRecord:
    create: true
    group: "OPS - PS - Core HR"
    managerGroup: "Change Managers - US"
    affectedGEOs: ["US"]
    notifyChannels: ["corehr-wcnp-alerts"]
  gslb:
    httpPortEnabled: false 
    lbRoutings:
      dev:
        cnames: [getassocidentifier-service.dev.walmart.net]
      stage:
        cnames: [getassocidentifier-service.stage.walmart.net]
      prod:
        cnames: [getassocidentifier-service.prod.walmart.net] 
  helm:
    values:
      livenessProbe:
        enabled: "true"
        headers: application/json, application/xml, text/plain, text/html
        probeInterval: 10
        wait: 30
        path: "/GetAssociateIdentifier/actuator/health"
        port: 8080
        failureThreshold: 3
      readinessProbe:
        enabled: "true"
        headers: application/json, application/xml, text/plain, text/html
        probeInterval: 15
        wait: 15
        path: "/GetAssociateIdentifier/actuator/health"
        port: 8080
        failureThreshold: 3
      min:
        cpu: 583m
        memory: 678Mi
      max:
        cpu: 1024m
        memory: 738Mi
      scaling:
        enabled: "true"
        cpuPercent: 60
        min: 5
        max: 6
      networking:
        httpsEnabled: true
        httpEnabled: true 
        httpsRedirect: true
  stages:
    - name: dev
      helm:
        values:
          env:
            JAVA_OPTS: "-Dspring.profiles.active=dev -Dssl.keyStoreFileName=/etc/secrets/certificate_dev.p12 -Dssl.trustStoreFileName=/etc/secrets/truststore_dev.jks"
          secrets:
             file_refresh: true
             files:
             - destination: /secrets.properties
               content: getassocservice-dev#secrets
             - destination: /certificate_dev.p12
               content: getassocservice-dev#certificate_dev
               base64decode: true
             - destination: /truststore_dev.jks
               content: getassocservice-dev#truststore_dev
               base64decode: true
          metadata:
             labels:
               strati.appkey: GTGA-ASSOCID-REST
               strati.env: Dev
             annotations:
               strati.passthroughUris: '[{"Path": "^/.*/swagger-ui.html$"},{"Path": "^/.*/webjars/.*$"},{"Path": "^/.*/swagger-resources$"},{"Path": "^/.*/swagger-resources/.*$"},{"Path": "^/.*/v2/api.docs$"}]'
      refs: [master,branch]
      changeRecord:
        create: false
      target:
        - cluster_id: [scus-dev-a3]
    - name: stage
      helm:
        values:
          env:
            JAVA_OPTS: "-Dspring.profiles.active=stage -Dssl.keyStoreFileName=/etc/secrets/certificate_dev.p12 -Dssl.trustStoreFileName=/etc/secrets/truststore_dev.jks"
          secrets:
             file_refresh: true
             files:
             - destination: /secrets.properties
               content: getassocservice-dev#secrets
             - destination: /certificate_dev.p12
               content: getassocservice-dev#certificate_dev
               base64decode: true
             - destination: /truststore_dev.jks
               content: getassocservice-dev#truststore_dev
               base64decode: true
          metadata:
             labels:
               strati.appkey: GTGA-ASSOCID-REST
               strati.env: stage
             annotations:
               strati.passthroughUris: '[{"Path": "^/.*/swagger-ui.html$"},{"Path": "^/.*/webjars/.*$"},{"Path": "^/.*/swagger-resources$"},{"Path": "^/.*/swagger-resources/.*$"},{"Path": "^/.*/v2/api.docs$"}]'
      refs: [master,branch]
      changeRecord:
        create: false
      target:
        - cluster_id: [scus-stage-a3]
    - name: prod
      helm:
        values:
          env:
            JAVA_OPTS: "-Dspring.profiles.active=prod -Dssl.keyStoreFileName=/etc/secrets/certificate_dev.p12 -Dssl.trustStoreFileName=/etc/secrets/truststore_dev.jks"
          secrets:
             file_refresh: true
             files:
             - destination: /secrets.properties
               content: getassocservice-dev#secrets
             - destination: /certificate_dev.p12
               content: getassocservice-dev#certificate_dev
               base64decode: true
             - destination: /truststore_dev.jks
               content: getassocservice-dev#truststore_dev
               base64decode: true
          metadata:
             labels:
               strati.appkey: GTGA-ASSOCID-REST
               strati.env: prod
             annotations:
               strati.passthroughUris: '[{"Path": "^/.*/swagger-ui.html$"},{"Path": "^/.*/webjars/.*$"},{"Path": "^/.*/swagger-resources$"},{"Path": "^/.*/swagger-resources/.*$"},{"Path": "^/.*/v2/api.docs$"}]'
      refs: [master,branch]
      changeRecord:
        create: true
      target:
        - cluster_id: [scus-prod-a18,wus-prod-a15]